<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href = "/login/style.css">
    <link rel="stylesheet" type="text/css" href = "/css/signupStyle.css">
    <title>Document</title>
</head>



<body>
	<div class="main_header" >
	        <div class="header_left" >
		        <a class ="leftA" href="/body1/body.html">
		        	<div class="header_left_icon">
		                <img class="icon_black" src="/header/imgs/icon_black.png">
		            </div>
		            <button class="velog_name">WelshCoding</button>
		        </a>
	            
	        </div>
	        <div class="header_right" >
	            
	        </div>
	</div>
	<br><br>
	
    <div class="bodyBack2">
    	<form class="subform" action="/goSignup"  method="POST" id="joinForm">
    		<h1>회원가입</h1>
		  	
		  	<p>
		    	<label for="userEmail">이메일 아이디 :</label>
		    	<input type="text" id="userEmail"  name="userEmail">
		    	<input class="dubckBtn" type="button" value="중복확인" onclick="checkId(joinForm.userEmail.value)">
<!-- 					<p id="idCheckText">중복확인 버튼을 클릭하세요</p> -->
			</p>
		    
		    <p>
		    	<label for="userPw">비밀번호 :</label>
		    	<input type="password" id="password" name="userPw">
		    </p>
		    <p>
				비밀번호 확인 :<input type="password" name="userPw_re" id="userPw_re">
			</p>
			
			<p>
				이름 :<input type="text" name="userName" id="userName">
			</p>
			
			<p>
				<div class="field birth">
			            <b>생년월일</b>
			            <div>
			                <input type="text" placeholder="년(4자)" name="userBirthyy">                
			                <select name="userBirthmm">
			                    <option value="">월</option>
			                    <option value="1">1월</option>
			                    <option value="2">2월</option>
			                    <option value="3">3월</option>
			                    <option value="4">4월</option>
			                    <option value="5">5월</option>
			                    <option value="6">6월</option>
			                    <option value="7">7월</option>
			                    <option value="8">8월</option>
			                    <option value="9">9월</option>
			                    <option value="10">10월</option>
			                    <option value="11">11월</option>
			                    <option value="12">12월</option>
			                </select>
			                <input type="text" placeholder="일" name="userBirthdd">
			            </div>
			        </div>
			 </p>
			 
			   <div>
	          		 <b>성별</b>
	                <label><input type="radio" name="gender" value="male">남자</label>
	                <label><input type="radio" name="gender" value="female">여자</label>
	           </div>
			 
			 <p>
				핸드폰 번호 <input type="text" name="userphone" id="userphone" placeholder="010-0000-0000">
			</p>
		    
		    <br>
		    <input type="button" value="회원가입" onclick="check()" class = "submitBtn">
    	</form>
    </div>
  
  
</body>
<script>
var ck = "not";
function checkId(email){
	 var emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
	
	if(email === "" || email.trim() === ""){
		alert("이메일을 입력해주세요.");
	    return;
	}
	// 이메일 형식 검사
	  if (!emailRegex.test(email)) {
	    alert("올바른 이메일 형식을 입력해주세요.");
	    return;
	  }
// 	alert(id);
	//ajax통신
	var xhr = new XMLHttpRequest();
	xhr.open("POST", "dubcheck", true);
	xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");

	var formData = "email=" + encodeURIComponent(email);
	xhr.send(formData);
	xhr.onreadystatechange = function(){
		if(xhr.readyState == 4){
			if(xhr.responseText.trim() == "ok"){
				alert("사용 가능한 아이디 입니다");
				ck="ok";
			}else{
				alert("이미 사용중인 아이디 입니다.");
				ck="not";
			}
			
		}
	}
}

function check() {
	  var form = document.getElementById("joinForm");

// 	  var emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;

	  // 전화번호 형식 검사 정규식
	  var phoneRegex = /^\d{3}-\d{3,4}-\d{4}$/;

	  // 입력값 가져오기
	  var userEmail = form.userEmail.value;
	  var userPw = form.userPw.value;
	  var userPw_re = form.userPw_re.value;
	  var userBirthyy = form.userBirthyy.value;
	  var userBirthmm = form.userBirthmm.value;
	  var userBirthdd = form.userBirthdd.value;
	  var userphone = form.userphone.value;
	  var genderMale = form.gender[0].checked;
	  var genderFemale = form.gender[1].checked;

	  // 입력값이 비어있는지 확인
	  if (
	    userPw === "" ||
	    userPw_re === "" ||
	    userBirthyy === "" ||
	    userBirthmm === "" ||
	    userBirthdd === "" ||
	    userphone === "" ||
	    (!genderMale && !genderFemale)
	  ) {
	    alert("입력값을 모두 입력해주세요.");
	    return;
	  }

	  
	  if(ck == "not"){
		alert("이메일 증복확인을 해주세요.");
		return; 				  
	  }

	  // 비밀번호 길이 및 일치 여부 검사
	  if (userPw.length < 4 || userPw.length > 20 || userPw !== userPw_re) {
	    alert("비밀번호는 4자 이상 20자 이하이며, 일치해야 합니다.");
	    return;
	  }

	  // 생년월일 숫자 입력 여부 검사
	  if (isNaN(userBirthyy) || isNaN(userBirthdd)) {
	    alert("생년월일은 숫자로 입력해주세요.");
	    return;
	  }

	  // 월 선택 여부 검사
	  if (userBirthmm === "") {
	    alert("생년월일의 월을 선택해주세요.");
	    return;
	  }

	  // 선택한 월이 1부터 12 사이인지 확인
	  if (userBirthmm < 1 || userBirthmm > 12) {
	    alert("올바른 월을 선택해주세요.");
	    return;
	  }

	  // 전화번호 형식 검사
	  if (!phoneRegex.test(userphone)) {
	    alert("올바른 전화번호 형식을 입력해주세요.");
	    return;
	  }

	  // 성별 선택 여부 검사
	  if (!genderMale && !genderFemale) {
	    alert("성별을 선택해주세요.");
	    return;
	  }

	  // 모든 조건을 통과한 경우 폼 제출
	  form.submit();
	}


</script>
</html>
